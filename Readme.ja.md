# 4D ウィジェット

4Dウィジェットはコンポーネントとして提供される機能で、フォームエディタあるいは定義済みのオブジェクトライブラリからアクセスできます。これらのウィジェットは複合オブジェクトで、標準機能へのアクセスを提供する定義済みの特性を持っていて、とても簡単に実装できます。

3つのウィジェットが利用できます:

- [SearchPicker](Documentation/SearchPicker.ja.md): 標準の外観を持つ検索エリア。
- [DatePicker](Documentation/DatePicker.ja.md): 日付セレクタ。
- [TimePicker](Documentation/TimePicker.ja.md): 時間セレクタ。

 > これらのウィジェットはプログラムなしで使用することができますし、またはプログラムで動作をカスタマイズすることもできます。フォームにウィジェットを配置し、デフォルトのプロパティをそのまま使用できます。
 > 動作をカスタマイズし、設定や制御を変更したい場合は、"コンポーネントメソッド"と呼ばれるメソッドを使用できます。コンポーネントメソッドはコンポーネントごとにリスト表示されます。

![](Documentation/images/pict307590.en.png)

このドキュメントではそれぞれのウィジェットごとにコンポーネントメソッドのシンタックスを説明します。

## ウィジェットの追加

ウィジェットエリアをフォームに挿入するには二通りの方法があります:

- オブジェクトライブラリを使用する方法
- サブフォームを使用する方法

### オブジェクトライブラリを使用する方法

ウィジェットをオブジェクトライブラリを使用して挿入するには、以下の手順に従って下さい:

1. **デザイン**メニューから**オブジェクトライブラリ**コマンドをを選択します。  
   オブジェクトライブラリウィンドウが開きます。
2. カテゴリメニューの中の**ウィジェット**を選択して下さい。  
   使用可能なウィジェットが全て表示されます:  
   ![](Documentation/images/pict307739.en.png)
3. 使用したいウィジェットをドラッグ&ドロップでフォームに挿入して下さい。  
   その後プロパティやオブジェクトメソッドを通じて設定を変更する事ができます。

### サブフォームを使用する方法

サブフォームタイプオブジェクトを使用してウィジェットを作成するには、以下の手順に従って下さい:

1. フォームエディター内に、サブフォームオブジェクトを追加して下さい。  
   これについての詳細は4D _Design Reference_ マニュアル内にあります。
2. プロパティリストで、「詳細フォーム」メニューをクリックして、使用可能なフォームのリストを表示します。このリストにはウィジェットも含まれています。  
   ![](Documentation/images/pict307757.en.png)
3. 挿入したいウィジェットを選択します。  
   その後、サブフォームのオブジェクトプロパティやオブジェクトメソッドを通じて設定を変更できます。

## 2ページ目以降においてウィジェットを初期化する

ウィジェットは4D サブフォームに基づいており、そのためサブフォームの動作原理に従います。これらの初期化には特に注意する必要があります。

最適化の目的のため、ソブフォームオブジェクトは4Dによって、サブフォームが表示されたときにのみインスタンス化されます。これはつまり [EXECUTE METHOD IN SUBFORM](https://developer.4d.com/docs/FormObjects/subformOverview/#execute-method-in-subform-command) を使用してのメソッドの呼び出しや、サブフォーム内の動的なオブジェクトへのアクセスは、カレントページにおいてサブフォームが表示されるまでは不可能ということです。

フォームの1ページ目以外にウィジェットを配置した場合、On Load フォームイベントの中で初期化メソッド（例えば [TimePicker SET STEP](Documentation/Methods/TimePicker%20SET%20STEP.ja.md)）を呼び出すことはできません。それはウィジェットが実行時にインスタンス化されないためです。

この場合に対処するため、ウィジェットエリアは値が-1の特殊なイベントを返して、ロードされて使用可能であることを示します。このイベントはウィジェット自体のオブジェクトメソッドレベルで、On Data Change、On Loadなどと同じようにテストされなければなりません。そのため、ウィジェットがフォームの1ページ目以外に置かれている場合、以下のように書く必要があります:

```4d
 If(FORM Event=-1) // ウィジェットがインスタンス化され初期化可能  
    TimePicker SET STEP("myTimePicker";? 00:10:00?) // 例  
 End if
```

以下のように書いた場合は正しくありません:

```4d
 If(FORM Event code=On Load) // これではウィジェットが1ページ目にある場合にのみ有効  
    TimePicker SET STEP("myTimePicker";? 00:10:00?)  
 End if
```
